#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ —Å AdsPower
–°–æ–¥–µ—Ä–∂–∏—Ç –º–∞—Å—Å–∏–≤ –¥–∞–Ω–Ω—ã—Ö (–∫–∞—Ä—Ç—ã, –∞–¥—Ä–µ—Å–∞, –ø—Ä–æ–∫—Å–∏) –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ü–∏–∫–ª
"""

import subprocess
import time
import sys
import os
import random
import string
from create_profile import create_profile, start_browser, stop_browser

# –ú–ê–°–°–ò–í–´ –î–ê–ù–ù–´–• –î–õ–Ø –ì–ï–ù–ï–†–ê–¶–ò–ò –ó–ê–ö–ê–ó–û–í

# –ú–∞—Å—Å–∏–≤ –∏–º–µ–Ω - –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã –∫–∞—Ä—Ç –æ–¥–Ω–æ –∏–º—è
FIRST_NAMES = [
    "Omar",      # –¥–ª—è –ø–∞—Ä—ã 1
    "Layla",     # –¥–ª—è –ø–∞—Ä—ã 2
    "Hassan"     # –¥–ª—è –ø–∞—Ä—ã 3
]

# –ú–∞—Å—Å–∏–≤ —Ñ–∞–º–∏–ª–∏–π - –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã –∫–∞—Ä—Ç –æ–¥–Ω–∞ —Ñ–∞–º–∏–ª–∏—è
LAST_NAMES = [
    "Al-Sabah",      # –¥–ª—è –ø–∞—Ä—ã 1
    "Al-Maktoum",    # –¥–ª—è –ø–∞—Ä—ã 2
    "Al-Nahyan"      # –¥–ª—è –ø–∞—Ä—ã 3
]

# –ú–∞—Å—Å–∏–≤ –∫–∞—Ä—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ –ø–∞—Ä (–¥–≤—É–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤)
CARDS = [
    # –ü–∞—Ä–∞ 1
    [
        ("5573770015136538", "09/30", "246"),  # –∫–∞—Ä—Ç–∞ 1.1
        ("5573770015175841", "09/30", "134")   # –∫–∞—Ä—Ç–∞ 1.2
    ],
    # –ü–∞—Ä–∞ 2
    [
        ("5573770015128477", "09/30", "582"),  # –∫–∞—Ä—Ç–∞ 2.1
        ("5573770015129269", "09/30", "834")   # –∫–∞—Ä—Ç–∞ 2.2
    ],
    # –ü–∞—Ä–∞ 3
    [
        ("5573770015183043", "09/30", "352"),  # –∫–∞—Ä—Ç–∞ 3.1
        ("5573770014913127", "09/30", "332")   # –∫–∞—Ä—Ç–∞ 3.2
    ]
]

# –ú–∞—Å—Å–∏–≤ –∞–¥—Ä–µ—Å–æ–≤ - –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã –∫–∞—Ä—Ç –æ–¥–∏–Ω –∞–¥—Ä–µ—Å
ADDRESSES = [
    "Princess**Tower",       # –¥–ª—è –ø–∞—Ä—ã 1
    "Princess++Tower",       # –¥–ª—è –ø–∞—Ä—ã 2
    "Princess##Tower"        # –¥–ª—è –ø–∞—Ä—ã 3
]

# –ú–∞—Å—Å–∏–≤ –∞–¥—Ä–µ—Å–æ–≤ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏ - –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã –∫–∞—Ä—Ç –æ–¥–∏–Ω –∞–¥—Ä–µ—Å
ADDRESS_LINE2 = [
    "42**floor**rm**4208",        # –¥–ª—è –ø–∞—Ä—ã 1
    "42++level++room++4208",      # –¥–ª—è –ø–∞—Ä—ã 2
    "42##floor##apt##4208"        # –¥–ª—è –ø–∞—Ä—ã 3
]

# –ú–∞—Å—Å–∏–≤ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ - –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã –∫–∞—Ä—Ç –æ–¥–∏–Ω —Ç–µ–ª–µ—Ñ–æ–Ω
PHONES = [
    "507384291",    # –¥–ª—è –ø–∞—Ä—ã 1
    "508472639",    # –¥–ª—è –ø–∞—Ä—ã 2
    "506293847"     # –¥–ª—è –ø–∞—Ä—ã 3
]

# –°—Ç–∞—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ (–≥–æ—Ä–æ–¥ –∏ –ø—Ä–æ–≤–∏–Ω—Ü–∏—è –æ—Å—Ç–∞—é—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏)
STATIC_ADDRESS = {
    "city": "Dubai",
    "province": "Dubai Marina"
}

# –ü—Ä–æ–∫—Å–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∞–µ–º –∏–∑ AdsPower –±—Ä–∞—É–∑–µ—Ä–∞ —á–µ—Ä–µ–∑ API

def generate_email(name, last_name):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ—Å—Ç–æ–π email –≤ —Ñ–æ—Ä–º–∞—Ç–µ: –∏–º—è.—Ñ–∞–º–∏–ª–∏—è + 3—Ü–∏—Ñ—Ä—ã@gmail.com"""
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 3 —Å–ª—É—á–∞–π–Ω—ã–µ —Ü–∏—Ñ—Ä—ã
    number = random.randint(100, 999)
    # –ß–µ—Ä–µ–¥—É–µ–º –º–µ–∂–¥—É gmail –∏ yahoo
    domains = ["gmail.com", "yahoo.com"]
    domain = random.choice(domains)
    return f"{name.lower()}.{last_name.lower()}{number}@{domain}"

def generate_password():
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π –ø–∞—Ä–æ–ª—å –∏–∑ 14 —Å–∏–º–≤–æ–ª–æ–≤"""
    return ''.join(random.choices(string.ascii_letters + string.digits, k=14))

def generate_order_data(pair_index, card_in_pair_index):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –ø–∞—Ä—ã –∫–∞—Ä—Ç –∏ –∫–∞—Ä—Ç—ã –≤ –ø–∞—Ä–µ"""
    card_number, card_expiry, card_cvc = CARDS[pair_index][card_in_pair_index]  # –ë–µ—Ä–µ–º –∫–∞—Ä—Ç—É –∏–∑ –ø–∞—Ä—ã
    first_name = FIRST_NAMES[pair_index]        # –ë–µ—Ä–µ–º –∏–º—è –¥–ª—è –ø–∞—Ä—ã
    last_name = LAST_NAMES[pair_index]          # –ë–µ—Ä–µ–º —Ñ–∞–º–∏–ª–∏—é –¥–ª—è –ø–∞—Ä—ã
    address = ADDRESSES[pair_index]             # –ë–µ—Ä–µ–º –∞–¥—Ä–µ—Å –¥–ª—è –ø–∞—Ä—ã
    address_line2 = ADDRESS_LINE2[pair_index]   # –ë–µ—Ä–µ–º –∞–¥—Ä–µ—Å2 –¥–ª—è –ø–∞—Ä—ã
    phone = PHONES[pair_index]                  # –ë–µ—Ä–µ–º —Ç–µ–ª–µ—Ñ–æ–Ω –¥–ª—è –ø–∞—Ä—ã
    
    return {
        # –î–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç–∞
        "email": generate_email(first_name, last_name),
        "password": generate_password(),
        
        # –î–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç–∞–≤–∫–∏
        "first_name": first_name,
        "last_name": last_name,
        "address": address,
        "address_line2": address_line2,
        "city": STATIC_ADDRESS["city"],
        "province": STATIC_ADDRESS["province"],
        "phone": phone,
        
        # –î–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã
        "card_number": card_number,
        "card_expiry": card_expiry,
        "card_cvc": card_cvc,
        "card_name": f"{first_name} {last_name}"
    }

def run_single_attempt_with_two_cards(pair_index, attempt_num):
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ–ø—ã—Ç–∫—É —Å –¥–≤—É–º—è –∫–∞—Ä—Ç–∞–º–∏ –Ω–∞ –æ–¥–∏–Ω –∞–∫–∫–∞—É–Ω—Ç"""
    print(f"\nüìã –ü–æ–ø—ã—Ç–∫–∞ #{attempt_num} (–ü–∞—Ä–∞ –∫–∞—Ä—Ç #{pair_index + 1}):")
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç–∞ (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –¥–ª—è –æ–±–µ–∏—Ö –∫–∞—Ä—Ç)
    order_data = generate_order_data(pair_index, 0)  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–≤—É—é –∫–∞—Ä—Ç—É –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–∞
    
    print(f"   üë§ {order_data['first_name']} {order_data['last_name']}")
    print(f"   üìß {order_data['email']}")
    print(f"   üìç {order_data['address']}")
    print(f"   üìû {order_data['phone']}")
    
    try:
        from bot_example import attempt_registration
        
        # –ü–æ–ª—É—á–∞–µ–º –æ–±–µ –∫–∞—Ä—Ç—ã –∏–∑ –ø–∞—Ä—ã
        card1_data = generate_order_data(pair_index, 0)
        card2_data = generate_order_data(pair_index, 1)
        
        print(f"   üí≥ –ö–∞—Ä—Ç–∞ 1: {card1_data['card_number']}")
        print(f"   üí≥ –ö–∞—Ä—Ç–∞ 2: {card2_data['card_number']}")
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞ —Å –¥–≤—É–º—è –∫–∞—Ä—Ç–∞–º–∏
        success = attempt_registration(1, 0, card1_data, return_driver=False, second_card_data=card2_data)
        
        if success:
            print(f"‚úÖ –ü–æ–ø—ã—Ç–∫–∞ #{attempt_num} —É—Å–ø–µ—à–Ω–∞!")
            return True
        else:
            print(f"‚ùå –ü–æ–ø—ã—Ç–∫–∞ #{attempt_num} –Ω–µ —É–¥–∞–ª–∞—Å—å!")
            return False
            
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –≤ –ø–æ–ø—ã—Ç–∫–µ #{attempt_num}: {e}")
        return False

def run_pair_attempts(pair_index, order_counter):
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ–ø—ã—Ç–∫–∏ –¥–ª—è –ø–∞—Ä—ã –∫–∞—Ä—Ç –≤ –æ–¥–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ"""
    print(f"\n{'='*60}")
    print(f"üöÄ –ü–ê–†–ê –ö–ê–†–¢ #{pair_index + 1}:")
    print(f"   üí≥ –ö–∞—Ä—Ç–∞ 1: {CARDS[pair_index][0][0]}")
    print(f"   üí≥ –ö–∞—Ä—Ç–∞ 2: {CARDS[pair_index][1][0]}")
    print(f"üåê –°–æ–∑–¥–∞–µ–º –±—Ä–∞—É–∑–µ—Ä —Å –ø—Ä–æ–∫—Å–∏ –∏–∑ AdsPower")
    print(f"{'='*60}")
    
    user_id = None
    browser_info = None
    
    try:
        # 1. –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å —Å –ø—Ä–æ–∫—Å–∏ –∏–∑ AdsPower
        print("1Ô∏è‚É£ –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å —Å –ø—Ä–æ–∫—Å–∏ –∏–∑ AdsPower...")
        proxy_index = order_counter % 100  # –ò—Å–ø–æ–ª—å–∑—É–µ–º order_counter –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–∫—Å–∏
        user_id = create_profile_with_proxy(proxy_index)
        
        if not user_id:
            print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å!")
            return False
        
        print(f"‚úÖ –ü—Ä–æ—Ñ–∏–ª—å —Å–æ–∑–¥–∞–Ω: {user_id}")
        time.sleep(5)
        
        # 2. –ó–∞–ø—É—Å–∫–∞–µ–º –±—Ä–∞—É–∑–µ—Ä
        print("2Ô∏è‚É£ –ó–∞–ø—É—Å–∫–∞–µ–º –±—Ä–∞—É–∑–µ—Ä...")
        browser_info = start_browser(user_id)
        
        if not browser_info["success"]:
            print(f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä: {browser_info['error']}")
            return False
        
        print(f"‚úÖ –ë—Ä–∞—É–∑–µ—Ä –∑–∞–ø—É—â–µ–Ω: {browser_info['debug_port']}")
        time.sleep(10)
        
        # 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –±–æ—Ç–∞
        os.environ['ADSPOWER_DEBUG_PORT'] = str(browser_info['debug_port'])
        if 'webdriver_path' in browser_info:
            os.environ['ADSPOWER_WEBDRIVER_PATH'] = browser_info['webdriver_path']
        
        # 4. –î–µ–ª–∞–µ–º –ø–æ–ø—ã—Ç–∫—É —Å –ø–∞—Ä–æ–π –∫–∞—Ä—Ç –≤ –æ–¥–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ
        pair_success = run_single_attempt_with_two_cards(pair_index, 1)
        
        if pair_success:
            print(f"üéâ –ü–ê–†–ê –ö–ê–†–¢ #{pair_index + 1} –í–´–ü–û–õ–ù–ï–ù–ê –£–°–ü–ï–®–ù–û!")
        else:
            print(f"‚ùå –ü–∞—Ä–∞ –∫–∞—Ä—Ç #{pair_index + 1} –Ω–µ —É–¥–∞–ª–∞—Å—å")
        
        return pair_success
            
    except KeyboardInterrupt:
        print(f"\n‚è∏Ô∏è –ü–∞—Ä–∞ –∫–∞—Ä—Ç #{pair_index + 1} –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
        return False
        
    except Exception as e:
        print(f"\n‚ùå –û—à–∏–±–∫–∞ –≤ –ø–∞—Ä–µ –∫–∞—Ä—Ç #{pair_index + 1}: {e}")
        return False
        
    finally:
        # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±—Ä–∞—É–∑–µ—Ä —Ç–æ–ª—å–∫–æ –≤ –∫–æ–Ω—Ü–µ –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫
        if user_id:
            print(f"3Ô∏è‚É£ –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±—Ä–∞—É–∑–µ—Ä –¥–ª—è –ø–∞—Ä—ã –∫–∞—Ä—Ç #{pair_index + 1}...")
            stop_browser(user_id)
            time.sleep(5)

def run_all_pairs_in_browser(browser_number):
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –æ–¥–Ω—É –ø–∞—Ä—É –∫–∞—Ä—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ"""
    user_id = None
    browser_info = None
    successful_attempts = 0
    
    try:
        # 1. –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å —Å –ø—Ä–æ–∫—Å–∏ –∏–∑ AdsPower
        print("1Ô∏è‚É£ –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å —Å –ø—Ä–æ–∫—Å–∏ –∏–∑ AdsPower...")
        user_id = create_profile_with_proxy(browser_number)
        
        if not user_id:
            print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å!")
            return 0
        
        print(f"‚úÖ –ü—Ä–æ—Ñ–∏–ª—å —Å–æ–∑–¥–∞–Ω: {user_id}")
        time.sleep(5)
        
        # 2. –ó–∞–ø—É—Å–∫–∞–µ–º –±—Ä–∞—É–∑–µ—Ä
        print("2Ô∏è‚É£ –ó–∞–ø—É—Å–∫–∞–µ–º –±—Ä–∞—É–∑–µ—Ä...")
        browser_info = start_browser(user_id)
        
        if not browser_info["success"]:
            print(f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä: {browser_info['error']}")
            return 0
        
        print(f"‚úÖ –ë—Ä–∞—É–∑–µ—Ä –∑–∞–ø—É—â–µ–Ω: {browser_info['debug_port']}")
        time.sleep(10)
        
        # 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –±–æ—Ç–∞
        os.environ['ADSPOWER_DEBUG_PORT'] = str(browser_info['debug_port'])
        if 'webdriver_path' in browser_info:
            os.environ['ADSPOWER_WEBDRIVER_PATH'] = browser_info['webdriver_path']
        
        # 4. –î–µ–ª–∞–µ–º –ø–æ–ø—ã—Ç–∫—É —Å –æ–¥–Ω–æ–π –ø–∞—Ä–æ–π –∫–∞—Ä—Ç –≤ —ç—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–µ
        pair_index = browser_number - 1  # browser_number –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 1, pair_index —Å 0
        print(f"\nüéØ –ë—Ä–∞—É–∑–µ—Ä #{browser_number} –ø—Ä–æ–±—É–µ—Ç –ø–∞—Ä—É –∫–∞—Ä—Ç #{pair_index + 1}")
        
        success = run_single_attempt_with_two_cards(pair_index, 1)
        
        if success:
            successful_attempts += 1
            print(f"üéâ –ü–ê–†–ê –ö–ê–†–¢ #{pair_index + 1} –í–´–ü–û–õ–ù–ï–ù–ê –£–°–ü–ï–®–ù–û!")
        else:
            print(f"‚ùå –ü–∞—Ä–∞ –∫–∞—Ä—Ç #{pair_index + 1} –Ω–µ —É–¥–∞–ª–∞—Å—å")
        
        return successful_attempts
            
    except KeyboardInterrupt:
        print(f"\n‚è∏Ô∏è –ë—Ä–∞—É–∑–µ—Ä #{browser_number} –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
        return successful_attempts
        
    except Exception as e:
        print(f"\n‚ùå –û—à–∏–±–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ #{browser_number}: {e}")
        return successful_attempts
        
    finally:
        # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±—Ä–∞—É–∑–µ—Ä –≤ –∫–æ–Ω—Ü–µ –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫
        if user_id:
            print(f"3Ô∏è‚É£ –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±—Ä–∞—É–∑–µ—Ä #{browser_number}...")
            stop_browser(user_id)
            time.sleep(2)

def create_profile_with_proxy(proxy_index=None):
    """–°–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å —Å –ø—Ä–æ–∫—Å–∏ –∏–∑ AdsPower"""
    # –ü—Ä–æ–∫—Å–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ AdsPower —á–µ—Ä–µ–∑ create_profile()
    return create_profile(proxy_index)

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è - –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ü–∏–∫–ª –±—Ä–∞—É–∑–µ—Ä–æ–≤ (–∫–∞–∂–¥—ã–π –±—Ä–∞—É–∑–µ—Ä = –æ–¥–Ω–∞ –ø–∞—Ä–∞ –∫–∞—Ä—Ç)"""
    print("=== –ó–ê–ü–£–°–ö –¶–ò–ö–õ–ê –ó–ê–ö–ê–ó–û–í –° ADSPOWER ===")
    print(f"üí≥ –ü–∞—Ä –∫–∞—Ä—Ç: {len(CARDS)}")
    print(f"üí≥ –í—Å–µ–≥–æ –∫–∞—Ä—Ç: {len(CARDS) * 2}")
    print(f"üîÑ –õ–æ–≥–∏–∫–∞: 1 –∞–∫–∫–∞—É–Ω—Ç = 2 –∫–∞—Ä—Ç—ã (–µ—Å–ª–∏ –ø–µ—Ä–≤–∞—è –Ω–µ –ø—Ä–æ—à–ª–∞, –ø—Ä–æ–±—É–µ–º –≤—Ç–æ—Ä—É—é)")
    print(f"üìç –ê–¥—Ä–µ—Å: {ADDRESSES[0]} (Princess Tower)")
    print(f"üè¢ –ì–æ—Ä–æ–¥: {STATIC_ADDRESS['city']}")
    print("=" * 60)
    
    successful_orders = 0
    failed_orders = 0
    browser_counter = 0
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä –∫–∞—Ä—Ç
    total_pairs = len(CARDS)
    print(f"üìä –í—Å–µ–≥–æ –ø–∞—Ä –∫–∞—Ä—Ç: {total_pairs}")
    print(f"üîÑ –ö–∞–∂–¥–∞—è –ø–∞—Ä–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ")
    print(f"üéØ –í—Å–µ–≥–æ –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–æ: {total_pairs}")
    print("=" * 60)
    
    # –¶–∏–∫–ª –±—Ä–∞—É–∑–µ—Ä–æ–≤ (–∫–∞–∂–¥—ã–π –±—Ä–∞—É–∑–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–¥–Ω—É –ø–∞—Ä—É –∫–∞—Ä—Ç)
    for browser_number in range(1, total_pairs + 1):
        try:
            print(f"\n{'='*60}")
            print(f"üåê –ë–†–ê–£–ó–ï–† #{browser_number}")
            print(f"üéØ –ü–∞—Ä–∞ –∫–∞—Ä—Ç –≤ —ç—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–µ: #{browser_number}")
            print(f"{'='*60}")
            
            # –ó–∞–ø—É—Å–∫–∞–µ–º –æ–¥–Ω—É –ø–∞—Ä—É –∫–∞—Ä—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ
            browser_success = run_all_pairs_in_browser(browser_number)
            
            if browser_success > 0:
                successful_orders += browser_success
                print(f"üéâ –ë–†–ê–£–ó–ï–† #{browser_number}: {browser_success} —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤!")
            else:
                failed_orders += 1
                print(f"üí• –ë–†–ê–£–ó–ï–† #{browser_number}: –ø–∞—Ä–∞ –∫–∞—Ä—Ç –Ω–µ—É–¥–∞—á–Ω–∞")
            
            # –ü–∞—É–∑–∞ –º–µ–∂–¥—É –±—Ä–∞—É–∑–µ—Ä–∞–º–∏
            print(f"\n‚è≥ –ü–∞—É–∑–∞ 10 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º...")
            time.sleep(10)
                
        except KeyboardInterrupt:
            print(f"\n‚è∏Ô∏è –¶–∏–∫–ª –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –Ω–∞ –±—Ä–∞—É–∑–µ—Ä–µ #{browser_number}")
            break
        except Exception as e:
            print(f"\n‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ #{browser_number}: {e}")
            failed_orders += 1
    
    # –í—Å–µ –ø–∞—Ä—ã –∫–∞—Ä—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã
    print(f"\n{'='*60}")
    print(f"üèÅ –í–°–ï –ü–ê–†–´ –ö–ê–†–¢ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–´!")
    print(f"üìä –ó–∞–ø—É—â–µ–Ω–æ –±—Ä–∞—É–∑–µ—Ä–æ–≤: {total_pairs}")
    print(f"üéØ –ö–∞–∂–¥–∞—è –ø–∞—Ä–∞ –ø–æ–ª—É—á–∏–ª–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä —Å 2 –∫–∞—Ä—Ç–∞–º–∏")
    print(f"{'='*60}")
    
    # –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    print(f"\n{'='*60}")
    print("üìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:")
    print(f"‚úÖ –£—Å–ø–µ—à–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤: {successful_orders}")
    print(f"‚ùå –ù–µ—É–¥–∞—á–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤: {failed_orders}")
    print(f"üìà –£—Å–ø–µ—à–Ω–æ—Å—Ç—å: {(successful_orders/(successful_orders+failed_orders)*100):.1f}%" if (successful_orders+failed_orders) > 0 else "0%")
    print(f"{'='*60}")

if __name__ == "__main__":
    main()
